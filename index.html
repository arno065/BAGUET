<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BAGUET FINDER - Localisateur de Distributeurs de Baguettes</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <style>
        body, html {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: 'Open Dyslexic', Arial, sans-serif;
            background-color: #D3B12A; /* Couleur de fond inspirée de la baguette */
        }

        @font-face {
            font-family: 'Open Dyslexic';
            src: url('https://cdn.jsdelivr.net/npm/open-dyslexic@1.0.3/open-dyslexic-regular.woff') format('woff');
            font-weight: normal;
            font-style: normal;
        }

        #app {
            display: flex;
            height: 100%;
        }

        #sidebar {
            width: 400px;
            background-color: #F5DEB3; /* Couleur crème pour évoquer la baguette */
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            box-shadow: 2px 2px 15px rgba(0, 0, 0, 0.3);
        }

        #map-title {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            color: #8B4513; /* Couleur marron pour ressembler à une baguette */
            margin-bottom: 10px;
        }

        #preferences {
            background-color: #FFEFD5; /* Couleur douce */
            padding: 15px;
            border-radius: 15px;
            border: 2px solid #D2691E; /* Marron clair */
            margin-bottom: 20px;
        }

        #distributors-list {
            flex-grow: 1;
            overflow-y: auto;
        }

        #map-container {
            flex-grow: 1;
            position: relative;
            height: 100%; /* Ensures the map takes full height */
        }

        #map {
            height: 100%; /* Ensures the map takes full height of its container */
            width: 100%;  /* Ensures the map takes full width of its container */
        }

        .distributor-item {
            background-color: #FFEFD5; /* Couleur douce pour chaque distributeur */
            margin-bottom: 10px;
            padding: 15px;
            border-radius: 15px;
            border: 2px solid #D2691E;
            transition: transform 0.2s;
        }

        .distributor-item:hover {
            transform: scale(1.02); /* Effet d'agrandissement au survol */
        }

        .stars {
            color: #FFD700; /* Couleur des étoiles */
        }

        .favorite {
            color: gold;
            cursor: pointer;
        }

        #language-select {
            margin-bottom: 10px;
        }

        .status-available {
            color: green;
        }

        .status-unavailable {
            color: red;
        }

        .status-empty {
            color: orange;
        }

        #add-distributor-form input,
        #add-distributor-form select {
            width: 100%;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div id="app">
        <div id="sidebar">
            <div id="preferences">
                <h2>Préférences</h2>
                <label for="language-select">Langue :</label>
                <select id="language-select">
                    <option value="fr">Français</option>
                    <option value="en">English</option>
                </select>
                <h3>Favoris</h3>
                <ul id="favorites-list"></ul>
                <h3>Historique de recherche</h3>
                <ul id="search-history"></ul>
                <h3>Points de fidélité</h3>
                <p>Vos points : <span id="loyalty-points">0</span></p>
            </div>
            <div id="add-distributor-form">
                <h3>Ajouter un nouveau distributeur</h3>
                <form id="new-distributor-form">
                    <input type="text" id="new-name" placeholder="Nom" required>
                    <input type="text" id="new-address" placeholder="Adresse" required>
                    <input type="number" id="new-price" step="0.01" placeholder="Prix" required>
                    <select id="new-payment" multiple required>
                        <option value="cash">Espèces</option>
                        <option value="card">Carte</option>
                    </select>
                    <input type="text" id="new-photo" placeholder="URL de la photo" required>
                    <button type="submit">Soumettre pour modération</button>
                </form>
            </div>
            <div id="distributors-list"></div>
        </div>
        <div id="map-container">
            <div id="map-title">Carte des Distributeurs de Baguettes en France</div>
            <div id="map"></div>
        </div>
    </div>

    <script>
        // Les données des distributeurs avec des photos
        let distributors = [
            { id: 1, name: "Distributeur Boulangerie Paul", lat: 48.8584, lng: 2.2945, address: "123 Rue de Paris", price: 1.20, rating: 4, payment: ["cash", "card"], reviews: [], status: "available", photo: "https://via.placeholder.com/150" },
            { id: 2, name: "Distri-Baguette Express", lat: 48.8738, lng: 2.2950, address: "45 Avenue des Champs-Élysées", price: 1.10, rating: 3, payment: ["cash"], reviews: [], status: "unavailable", photo: "https://via.placeholder.com/150" },
            { id: 3, name: "Le Petit Boulanger Automatique", lat: 48.8600, lng: 2.3400, address: "78 Boulevard Saint-Michel", price: 1.30, rating: 5, payment: ["card"], reviews: [], status: "empty", photo: "https://via.placeholder.com/150" },
            { id: 4, name: "Baguette d'Or", lat: 48.8566, lng: 2.3522, address: "5 Rue de Rivoli", price: 1.50, rating: 4, payment: ["cash"], reviews: [], status: "available", photo: "https://via.placeholder.com/150" },
            { id: 5, name: "Boulangerie des Champs", lat: 48.8700, lng: 2.3300, address: "10 Rue des Filles du Calvaire", price: 1
            { id: 5, name: "Boulangerie des Champs", lat: 48.8700, lng: 2.3300, address: "10 Rue des Filles du Calvaire", price: 1.45, rating: 4, payment: ["card", "cash"], reviews: [], status: "available", photo: "https://via.placeholder.com/150" }
        ];

        const map = L.map('map').setView([48.8566, 2.3522], 12); // Vue centrée sur Paris

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        function ajouterMarqueurs() {
            distributors.forEach(distributor => {
                const marker = L.marker([distributor.lat, distributor.lng]).addTo(map);
                marker.bindPopup(`
                    <strong>${distributor.name}</strong><br>
                    <img src="${distributor.photo}" alt="Photo de ${distributor.name}" style="width: 100px;"><br>
                    Adresse: ${distributor.address}<br>
                    Prix: €${distributor.price}<br>
                    Évaluation: ${'★'.repeat(distributor.rating)}<br>
                    <span class="status-${distributor.status}">Statut: ${distributor.status.charAt(0).toUpperCase() + distributor.status.slice(1)}</span>
                `);
            });
        }

        document.getElementById('new-distributor-form').addEventListener('submit', function(event) {
            event.preventDefault(); // Empêche le rechargement de la page

            const name = document.getElementById('new-name').value;
            const address = document.getElementById('new-address').value;
            const price = parseFloat(document.getElementById('new-price').value);
            const payment = Array.from(document.getElementById('new-payment').selectedOptions).map(option => option.value);
            const photo = document.getElementById('new-photo').value;

            // Ajouter le nouveau distributeur à la liste
            const newDistributor = {
                id: distributors.length + 1,
                name,
                lat: 48.8566, // Utiliser une latitude par défaut pour la démo
                lng: 2.3522, // Utiliser une longitude par défaut pour la démo
                address,
                price,
                rating: 0, // Évaluation par défaut
                payment,
                reviews: [],
                status: "available", // Statut par défaut
                photo
            };
            distributors.push(newDistributor);

            // Réinitialiser le formulaire
            document.getElementById('new-distributor-form').reset();

            // Ajouter un marqueur pour le nouveau distributeur
            const marker = L.marker([newDistributor.lat, newDistributor.lng]).addTo(map);
            marker.bindPopup(`
                <strong>${newDistributor.name}</strong><br>
                <img src="${newDistributor.photo}" alt="Photo de ${newDistributor.name}" style="width: 100px;"><br>
                Adresse: ${newDistributor.address}<br>
                Prix: €${newDistributor.price}<br>
                Évaluation: ${'★'.repeat(newDistributor.rating)}<br>
                <span class="status-${newDistributor.status}">Statut: ${newDistributor.status.charAt(0).toUpperCase() + newDistributor.status.slice(1)}</span>
            `);
        });

        ajouterMarqueurs(); // Appel initial pour ajouter les marqueurs sur la carte
    </script>
</body>
</html>
