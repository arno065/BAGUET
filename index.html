<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BAGUET FINDER - Localisateur de Distributeurs de Baguettes</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <style>
        body, html {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: 'Open Dyslexic', Arial, sans-serif;
            background-color: #D3B12A; /* Couleur de fond inspirée de la baguette */
        }
        @font-face {
            font-family: 'Open Dyslexic';
            src: url('https://cdn.jsdelivr.net/npm/open-dyslexic@1.0.4/open-dyslexic-regular.woff2') format('woff2');
            font-weight: normal;
            font-style: normal;
        }
        #app {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        #sidebar {
            width: 100%;
            max-width: 400px;
            background-color: #F5DEB3;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            box-shadow: 2px 2px 15px rgba(0, 0, 0, 0.3);
        }
        #preferences {
            background-color: #FFEFD5;
            padding: 15px;
            border-radius: 15px;
            border: 2px solid #D2691E;
            margin-bottom: 20px;
        }
        #map-container {
            flex-grow: 1;
            position: relative;
        }
        #map {
            height: 100%;
            width: 100%;
        }
        /* Ajoutez d'autres styles ici selon vos besoins */
    </style>
</head>
<body>
    <div id="app">
        <div id="sidebar">
            <div id="preferences">
                <h2>Préférences</h2>
                <label for="language-select">Langue :</label>
                <select id="language-select">
                    <option value="fr">Français</option>
                    <option value="en">English</option>
                </select>
                <h3>Favoris</h3>
                <ul id="favorites-list"></ul>
                <h3>Historique de recherche</h3>
                <ul id="search-history"></ul>
                <h3>Points de fidélité</h3>
                <p>Vos points : <span id="loyalty-points">0</span></p>
            </div>
            <div id="add-distributor-form">
                <h3>Ajouter un nouveau distributeur</h3>
                <form id="new-distributor-form">
                    <input type="text" id="new-name" placeholder="Nom" required>
                    <input type="text" id="new-address" placeholder="Adresse" required>
                    <input type="number" id="new-price" step="0.01" placeholder="Prix" required>
                    <select id="new-payment" multiple required>
                        <option value="cash">Espèces</option>
                        <option value="card">Carte</option>
                    </select>
                    <input type="text" id="new-photo" placeholder="URL de la photo" required>
                    <button type="submit">Soumettre pour modération</button>
                </form>
            </div>
            <div id="distributors-list"></div>
        </div>
        <div id="map-container">
            <div id="map"></div>
        </div>
    </div>

    <script>
        const distributors = generateRandomDistributors(50); // Générer 50 distributeurs aléatoires
        let map;
        let markers = [];

        function generateRandomDistributors(num) {
            const distributorNames = [
                "Boulangerie Artisanale",
                "Le Fournil du Coin",
                "Distributeur de Baguettes",
                "Pain et Gourmandises",
                "Baguette Express",
                "La Boulangerie à Emporter",
                "Le Pain Quotidien",
                "Distri-Baguette",
                "Les Délices de France",
                "Boulangerie Française"
            ];

            const latitudes = [
                48.8566,  // Paris
                43.6047,  // Toulouse
                48.5734,  // Strasbourg
                45.7640,  // Lyon
                44.8378,  // Bordeaux
                48.1114,  // Nice
                43.2931,  // Marseille
                47.2184,  // Nantes
                50.6292,  // Lille
                49.4444   // Metz
            ];

            const longitudes = [
                2.3522,   // Paris
                1.4442,   // Toulouse
                7.7521,   // Strasbourg
                4.8357,   // Lyon
                -0.5792,  // Bordeaux
                7.2619,   // Nice
                5.3745,   // Marseille
                -1.5532,  // Nantes
                3.0586,   // Lille
                6.1715    // Metz
            ];

            const distributors = [];
            for (let i = 0; i < num; i++) {
                const randomIndex = Math.floor(Math.random() * distributorNames.length);
                const lat = latitudes[randomIndex] + (Math.random() - 0.5) * 0.05; // Variation aléatoire
                const lng = longitudes[randomIndex] + (Math.random() - 0.5) * 0.05; // Variation aléatoire

                distributors.push({
                    id: i + 1,
                    name: distributorNames[randomIndex],
                    lat: lat,
                    lng: lng,
                    address: `${Math.floor(Math.random() * 100)} Rue ${distributorNames[randomIndex]}`,
                    price: (Math.random() * 2 + 0.5).toFixed(2), // Prix entre 0.5 et 2.5
                    rating: Math.floor(Math.random() * 6), // Évaluation entre 0 et 5
                    photo: "https://via.placeholder.com/150"
                });
            }
            return distributors;
        }

        function initializeMap() {
            map = L.map('map').setView([46.6034, 1.8883], 5); // Vue centrée sur la France
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                maxZoom: 19,
                attribution: '© OpenStreetMap'
            }).addTo(map);

            distributors.forEach(distributor => {
                const marker = L.marker([distributor.lat, distributor.lng]).addTo(map);
                markers.push(marker);
                marker.on('click', () => {
                    alert(`Nom: ${distributor.name}\nAdresse: ${distributor.address}`);
                });
            });
        }

        // Initialiser la carte après le chargement de la page
        document.addEventListener("DOMContentLoaded", initializeMap);
    </script>
</body>
</html>
        // Fonction pour afficher les détails du distributeur
function displayDistributorDetails(distributor) {
    const distributorDetails = `
        <h3>${distributor.name}</h3>
        <p>Adresse : ${distributor.address}</p>
        <p>Prix : €${distributor.price}</p>
        <p>Status : ${translations[currentLanguage][distributor.status]}</p>
        <p>Évaluation : ${'★'.repeat(distributor.rating)}${'☆'.repeat(5 - distributor.rating)} (${distributor.rating})</p>
        <button onclick="addToFavorites(${distributor.id})">${translations[currentLanguage].favorite}</button>
        <button onclick="addReview(${distributor.id})">${translations[currentLanguage].addReview}</button>
        <button onclick="openInGoogleMaps(${distributor.lat}, ${distributor.lng})">${translations[currentLanguage].openInGoogleMaps}</button>
    `;
    document.getElementById('distributors-list').innerHTML = distributorDetails;
}

        // Ajouter un distributeur aux favoris
function addToFavorites(id) {
    const distributor = distributors.find(d => d.id === id);
    if (distributor && !favorites.includes(distributor)) {
        favorites.push(distributor);
        updateFavoritesList();
        alert(`${distributor.name} ${translations[currentLanguage].favorite}`);
    }
}

        // Mettre à jour la liste des favoris
function updateFavoritesList() {
    const favoritesList = document.getElementById('favorites-list');
    favoritesList.innerHTML = '';
    favorites.forEach(fav => {
        const listItem = document.createElement('li');
        listItem.textContent = fav.name;
        favoritesList.appendChild(listItem);
    });
}

// Ajouter un avis
function addReview(id) {
    const review = prompt(translations[currentLanguage].seeReviews);
    if (review) {
        const distributor = distributors.find(d => d.id === id);
        distributor.reviews.push(review);
        alert(`${translations[currentLanguage].seeReviews}: ${review}`);
            }
        }

        // Ouvrir dans Google Maps
function openInGoogleMaps(lat, lng) {
    window.open(`https://www.google.com/maps?q=${lat},${lng}`, '_blank');
}

// Gestion des soumissions de formulaire
document.getElementById('new-distributor-form').addEventListener('submit', function (event) {
    event.preventDefault();
    const newDistributor = {
        id: distributors.length + 1,
        name: document.getElementById('new-name').value,
        address: document.getElementById('new-address').value,
        price: document.getElementById('new-price').value,
        payment: Array.from(document.getElementById('new-payment').selectedOptions).map(option => option.value),
        photo: document.getElementById('new-photo').value,
        rating: 0,
        reviews: [],
        status: "available", // Statut par défaut
        lat: 48.8566 + (Math.random() - 0.5) * 0.5, // Position aléatoire autour de Paris
        lng: 2.3522 + (Math.random() - 0.5) * 0.5
    };
            distributors.push(newDistributor);
    alert(`Distributeur ${newDistributor.name} soumis pour modération !`);
    this.reset(); // Réinitialiser le formulaire
    initializeMap(); // Réinitialiser la carte pour inclure le nouveau distributeur
});

// Initialiser la carte après le chargement de la page
document.addEventListener("DOMContentLoaded", function() {
    initializeMap();
    updateFavoritesList();
});

    </script>
</body>
</html>
